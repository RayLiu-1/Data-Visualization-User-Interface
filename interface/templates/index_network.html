<!DOCTYPE html>
<html>
<head>
<style>
div.container {
    width: 100%;
    border: 1px solid gray;
}

header {
    padding: 1em;
    color: white;
    background-color: black;
    clear: left;
    text-align: center;
}

nav {
    float: left;
    max-width: 300px;
    margin: 0;
    padding: 1em;
    height:500px;

}

   
nav ul a {
    text-decoration: none;
}

#mynetwork {
    margin-left: 310px;
    height:500px;
    border-left: 1px solid gray;
    padding: 1em;
    overflow: hidden;
}
</style>
    <script type="text/javascript" src="http://visjs.org/dist/vis.js"></script>

    
    <link href="http://visjs.org/dist/vis-network.min.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="https://raw.githubusercontent.com/dtao/lazy.js/master/lazy.js"></script>
    <script type="text/javascript">
    var nodes = null;
    var edges = null;
    var network = null;
    var gData = null;
    var question = "";
    var target ;
    var answer = ["", "", "", "", "", "", "", "", "", ""];
    function loadJSON(path, suc, error) {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    suc(JSON.parse(xhr.responseText));
                    gData = JSON.parse(xhr.responseText);
                }
                else {
                    error(xhr);
                }
            }
        };
        xhr.open('GET', path, true);
        xhr.send();
    }
    function loadfunction() {
        loadJSON('/questions/0000000000', setvar, function (err) { console.log('error') });
        loadJSON('/data/0000000000', draw, function (err) { console.log('error') });
    }
    function draw(gephiJSON) {
        
        
        console.log(gephiJSON);
        var data = Lazy(gephiJSON).pick([target])[0];
        var container = document.getElementById('mynetwork');
        var options = {
            nodes: {
                shape: 'dot',
            }
        };
        network = new vis.Network(container, data, options);
    }
    function setvar(gephiJSON) {
        question = gephiJSON.question;
        answer = gephiJSON.answer;
        target = gephiJSON.target;
    }
    </script>
    <script src="http://visjs.org/examples/googleAnalytics.js"></script>

</head>
<body  onload="loadfunction()">

    <div class="container">

        <header>
            <h1>City Gallery</h1>
        </header>

        <nav>
            <p onclick="defaultNet()" id="question"> </p>
            <script>
                document.getElementById("question").innerHTML = "<U>"+question+"</U>";
            </script>
            <form id="answers">
            </form>
            <button id="submit" onclick="clickhandler()">Go</button>
            <script>
                function setanwser(e, i) {
                    document.getElementById(e).innerHTML = "<input type=\"checkbox\" id =\"" + e + "\" onclick = \"choseNet(\'" + e + "\')><U>" + e + "</U><br>"
                }
                Lazy(answer).map(setanwser)
                function checkbox() {
                    var checkboxes = Lazy.repeat("checkbox", 10)
                    function getcheck(e) {
                        if( document.getElementById(e).checked == true)
                            return "1"
                        else return "0"
                    }
                    function strsum(x, y) { return x + y;}
                    
                    return Lazy(Lazy(answer).map(getcheck)).reduce(strsum)
                }
                function choseNet(e) {
                    var data = Lazy(gData).pick([e])[0];
                    var container = document.getElementById('mynetwork');
                    var options = {
                        nodes: {
                            shape: 'dot',
                        }
                    };
                    network = new vis.Network(container, data, options);
                }
                function clickhandler() {
                    loadJSON('/questions/<'+check()+'>', setvar, function (err) { console.log('error') });
                    loadJSON('/data/<'+check()+'>', store, function (err) { console.log('error') });
                    document.getElementById("question").innerHTML = question;
                    Lazy(answer).map(setanwser);
                    loadfunction();

                }
            </script>    
               
                

        </nav>

        <div id="mynetwork">
        </div>
    </div>
</body>
</html>
